/*! grunt-demo 2015-06-08 */
$(document).ready(function(){function a(){$.getJSON(t.init+"?jsoncallback=?",{uuid:q},function(a){1==a.msgcode?(s=a.shareid,i=a.points,WX.shareConfig({shareTitle:s+"感谢有你—《九阴真经》四周年庆",shareDesc:s+"感谢有你—《九阴真经》四周年庆",shareLink:"http://sg.9yin.woniu.com/act/201505/0528wxoldback/index.html?shareid="+s,shareImg:"http://9yin.woniu.com/static/main/new/images/logobg.png",appId:"wxf19a1094aa8c66bb"},{success:function(a){},fail:function(a){},cancel:function(a){},complete:function(a){},trigger:function(a){}}),$(".prizeNum").html(i+"点"),"0"==a.account?o=0:(o=1,$("#account").html(a.account))):alert(a.msg)})}function b(){$.getJSON(t.prizeLog+"?jsoncallback=?",{token:s},function(a){if(1==a.msgcode)if(n=1,o=1,w=a.prizeLog,a.prizeLog){if(a.prizeLog){for(var b,c=0;c<a.prizeLog.length;c++){switch(a.prizeLog[c].prize_type){case"box_dpj_wyfmp":$(".prizeImg01").addClass("gotImg").attr("src","images/got1.jpg");break;case"box_dpj_binglu113_10":$(".prizeImg02").addClass("gotImg").attr("src","images/got2.jpg");break;case"box_dpj_dlb":$(".prizeImg03").addClass("gotImg").attr("src","images/got3.jpg");break;case"box_dpj_t-shirt":$(".prizeImg04").addClass("gotImg").attr("src","images/got4.jpg")}b+="<tr><td>"+a.prizeLog[c].create_time.substring(0,10)+"</td><td>"+a.prizeLog[c].title+"</td></tr>"}$(".pop_record tbody").html(b)}}else $(".pop_record tbody").html('<tr><td colspan="2">暂无中奖信息</td></tr>');else 1001==a.msgcode?n=0:1006==a.msgcode&&(o=0)})}function c(){$.ajax({url:t.getGameAreaList,type:"post",dataType:"jsonp",jsonp:"jsoncallback",success:function(a){x=a.list;for(var b="",c="",d=0;d<x.length;d++){b+='<dd data-area="'+x[d].realareaid+'">'+x[d].areaname+"</dd>";for(var e=x[d].server_list,f=0;f<e.length;f++)c+='<dd class="area'+x[d].realareaid+'" data-server="'+e[f].id+'">'+e[f].name+"</dd>"}$(".os_list").html(b),$(".os_list-server").html(c),$(".os_type").click(function(){$(this).siblings(".os_list").show(),$(".os_list-server").hide()}),$(".os_list dd").click(function(){var a=$(this).html(),b=$(this).attr("data-area");$(".os_type-server").html("选择服务器"),$(".os_type").html(a),$(".os_type").attr("data-area",b),$(".os_list").hide(),$(".os_list-server dd").hide(),$(".area"+b).show()}),$(".os_type-server").click(function(){$(this).siblings(".os_list-server").show()}),$(".os_list-server dd").click(function(){var a=$(this).html(),b=$(this).attr("data-server");$(".os_type-server").html(a),$(".os_type-server").attr("data-server",b),$(".os_list-server").hide()})}})}function d(a,b){for(var c=0;c<x.length;c++)if(x[c].areaname==a)for(var d=x[c].areaid,e=x[c].server_list,f=0;f<e.length;f++)if(e[f].name==b)var g=e[f].id;return{areaId:d,serverId:g}}function e(a){var b=$(document).scrollTop(),c=$(window).height(),d=$("#"+a).height();$("#"+a).css("top",parseInt(b+(c-d)/2)+"px")}function f(a){var b=$(".container").height(),c=$(".container").width();a.css({height:b,width:c}).fadeTo("fast",.7)}function g(a){return a.fadeOut(300),!1}new Swiper(".swiper-container",{paginationClickable:!0,mode:"vertical"});$(".btn").click(function(){e("server"),$("#server,.show1").show()});var h=$(window).height();$(".wrap01").css("height",h),$(".wrap").css("height",h),$(".swiper-container").css("height",h);var i,j,k,l=new Senro,m=window.location.href,n=0,o=0,p=l.parseURLParams(m),q=p.gid,r=p.token,s=p.shareid,t={init:"http://gwact.woniu.com/9yin/h150527/init",zan:"http://gwact.woniu.com/9yin/h150527/zan",sendPrize:"http://gwact.woniu.com/9yin/h150527/sendPrize",getGameAreaList:"http://gwact.woniu.com/9yin/h150527/getGameAreaList",prizeLog:"http://gwact.woniu.com/9yin/h150527/prizeLog",bind:"http://gwact.woniu.com/9yin/h150527/bind",lucky:"http://gwact.woniu.com/9yin/h140722/lucky",lucky_log:"http://gwact.woniu.com/9yin/h140722/lucky_log",getServer:"http://wyy.woniu.com/wyy/client/member/getServer",bindServer:"http://wyy.woniu.com/wyy/client/member/bindServer"};if(l.cookie("set","share_id",s),s=l.cookie("get","share_id"),s&&null!=s)if(r&&null!=r){$(".tips_pop,.show1").hide(),e("callBack"),$("#callBack, .show1").show();var u=p.token;$(".submit-zan").click(function(){$.getJSON(t.zan+"?jsoncallback=?",{otherid:u,shareid:s},function(a){1==a.msgcode?(alert(a.msg),window.location.href="http://sg.9yin.woniu.com/act/201505/0528wxoldback/index.html"):alert(a.msg)})})}else{s=l.parseURLParams(m).shareid;var v="http://sg.9yin.woniu.com/act/201505/0528wxoldback/index.html&parameter=shareid-"+s;window.location.href="http://gwact.woniu.com/api/get3rd?redirectURL="+v}else q&&null!=q?(a(),$(".call-back-btn").click(function(){return s?($(".tips_pop,.show1").hide(),e("shares"),$("#shares, .show1").show(),!1):void a()}),$(".getPrize").click(function(){k?"box_dpj_dlb"==k?30>i?alert("仗剑点不足！"):$.getJSON(t.sendPrize+"?jsoncallback=?",{prize_type:k,server_id:"700010",token:s},function(a){if(1==a.msgcode){var b;switch(a.prize_type){case"box_dpj_wyfmp":b="五蕴伏魔品*10";break;case"box_dpj_binglu113_10":b="上等兵录*10";break;case"box_dpj_dlb":b="上等兵录*10";break;case"box_dpj_t-shirt":b="上等兵录*10"}$("#gotPrize").html(b),$(".tips_pop,.show1").hide(),e("gotIt"),$("#gotIt, .show1").show()}else alert(a.msg)}):"box_dpj_t-shirt"==k?30>i?alert("仗剑点不足!"):$.getJSON(t.sendPrize+"?jsoncallback=?",{prize_type:k,server_id:"700010",token:s},function(a){if(1==a.msgcode){var b;switch(a.prize_type){case"box_dpj_wyfmp":b="五蕴伏魔品*10";break;case"box_dpj_binglu113_10":b="上等兵录*10";break;case"box_dpj_dlb":b="上等兵录*10";break;case"box_dpj_t-shirt":b="上等兵录*10"}$("#gotPrize").html(b),$(".tips_pop,.show1").hide(),e("gotIt"),$("#gotIt, .show1").show()}else alert(a.msg)}):("box_dpj_wyfmp"==k||"box_dpj_binglu113_10"==k)&&(o?(alert("请选择服务器"),$(".tips_pop,.show1").hide(),e("server"),$("#server, .show1").show()):(alert("抱歉，您尚未绑定通行证帐号哟！"),e("login"),$("#login, .show1").show())):alert("请点击选择您要领取的奖品图片")})):$(".call-back-btn,.getPrize").click(function(){alert("请关注九阴真经官方微信号“ageofwushu”并回复关键字“周年庆”即可参加活动哦。")});$(".back-gift li").click(function(){$(this).find("img").hasClass("gotImg")?alert("奖品已领取"):($(".back-gift li[class*='current']").removeClass("current"),$(this).addClass("current"),k=$(this).find("img").data("name"))}),$(".submit-server").click(function(){var a=($(this).attr("data-value"),$(".os_type").attr("data-area")),b=$(".os_type-server").attr("data-server");""==a||""==b?alert("请选择服务器或者大区"):k?"box_dpj_wyfmp"==k&&5>i?alert("仗剑点不足！"):"box_dpj_binglu113_10"==k&&20>i?alert("仗剑点不足！"):$.getJSON(t.sendPrize+"?jsoncallback=?",{prize_type:k,server_id:b,token:s},function(a){if(1==a.msgcode){var b;switch(a.prize_type){case"box_dpj_wyfmp":b="五蕴伏魔品*10";break;case"box_dpj_binglu113_10":b="上等兵录*10";break;case"box_dpj_dlb":b="上等兵录*10";break;case"box_dpj_t-shirt":b="上等兵录*10"}$("#gotPrize").html(b),$(".tips_pop,.show1").hide(),e("gotIt"),$("#gotIt, .show1").show()}else alert(a.msg)}):alert("请选择要领取的奖品")}),$(".back-img li img").click(function(){$(".back-img li img[class*='current']").removeClass("current"),$(this).addClass("current"),j=$(this).data("id")}),c(),$(".submit-msg").click(function(){var a,b,c=$("#account").html(),f=$("#nowArea").html(),g=$("#nowServer").html(),h=d(f,g);a=h.areaId,b=h.serverId,$.ajax({url:t.lucky,type:"post",dataType:"jsonp",jsonp:"jsoncallback",data:{uuid:q,area_id:a,server_id:b,account:c},success:function(a){1==a.msgcode?($(".tips_pop,.show1").hide(),e("gotIt"),$("#gotIt, .show1").show()):(alert(a.msg),$(".tips_pop,.show1").hide())}})});var w=[];b(),$(".tips").click(function(){$(".tips_pop,.show1").hide(),e("tips"),$("#tips, .show1").show()}),$(".acgz").click(function(){b(),$(".tips_pop,.show1").hide(),e("records"),$("#records, .show1").show()}),$(".registerBtn").click(function(){$(".tips_pop,.show1").hide(),e("register"),$("#register, .show1").show()}),$(".submit-getPrize").click(function(){$(".award").html("已领取"),$(".award").addClass("award_got"),$(".award").removeClass("award"),$(".tips_pop").hide(),$(".show1").hide()}),$(".right,.submit-close").click(function(){$(".tips_pop").hide(),$(".show1").hide()});var x=[],y=$(".ys_Tab"),z=$(".nav");$(".container").append('<div class="show"></div>'),y.on("click",function(){f($(".show")),z.stop().animate({left:"0px"},200)}),$(".container").on("click",".show",function(){var a=$(".nav").width();z.stop().animate({left:"-"+(a+50)+"px"},200),g($(".show"))});var A=$("#ysLogin"),B=$("#ysReg");$show1=$(".show1");var C=$("#yslrTitle").find("a");A.click(function(){C.removeClass("yst_current"),C.eq(0).addClass("yst_current"),$(".yslrc_l").show(),$("#ysLoreg").show(),f($show1)}),B.click(function(){C.removeClass("yst_current"),C.eq(1).addClass("yst_current"),f($show1),$(".yslrc_r").show(),$("#ysLoreg").show()}),$show1.click(function(){$(".yslrc_l").hide(),$(".yslrc_r").hide(),$("#ysLoreg").hide(),g($show1)}),C.click(function(){var a=$(this).index();switch(C.removeClass("yst_current"),C.eq(a).addClass("yst_current"),a){case 0:$(".yslrc_l").show(),$(".yslrc_r").hide();break;case 1:$(".yslrc_r").show(),$(".yslrc_l").hide()}});var D=$("#loginBtn"),E=$("#yLogn"),F=$("#ylogpwd");D.on("click",function(){return""==E.val()?(alert("请输入正确蜗牛通行证"),!1):""==F.val()?(alert("请输入正确密码"),!1):void $.ajax({url:t.bind,type:"post",dataType:"jsonp",jsonp:"jsoncallback",data:{account:E.val(),password:F.val(),token:s},success:function(a){if(console.log(a),"1012"==a.msgcode){o=1,$(".ys_loginWrap").hide(),$(".ys_loginedWrap").show(),islogin=!0,$(".submit-server").attr("data-value",a.account),$(".tips_pop,.show1").hide();var b=$(document).scrollTop(),c=$(window).height(),d=$("#server").height();$("#server").css("top",b+(c-d)/2+"px"),$("#server, .show1").show(),$(".yslrc_l").hide(),$(".yslrc_r").hide(),$("#ysLoreg").hide()}else alert(a.msg)}})});var G=($("#asideRegister"),$(".registerPane")),H="registerPane--visible",I=$("#registerFinished"),J=$("#customRegister");new Passport({formId:"#customRegister",realname:{isAbsent:!0},identity:{isAbsent:!0},hiddenOptions:{gameid:10,pagetype:"GW",pagename:J.data("pagename")||"http://sg.9yin.woniu.com/act/201501/0112attention/index.html",fromurl:document.location.href},success:function(a){G.removeClass(H),I.addClass(H)}})});